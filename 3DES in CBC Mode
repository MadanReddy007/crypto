from Crypto.Cipher import DES3
from Crypto.Util.Padding import pad, unpad
from Crypto.Random import get_random_bytes

key = DES3.adjust_key_parity(get_random_bytes(24))
iv = get_random_bytes(8)
cipher = DES3.new(key, DES3.MODE_CBC, iv)

plaintext = b'Hello1234567890'
ciphertext = cipher.encrypt(pad(plaintext, 8))
print("3DES CBC Encrypted:", ciphertext)

decipher = DES3.new(key, DES3.MODE_CBC, iv)
decrypted = unpad(decipher.decrypt(ciphertext), 8)
print("Decrypted:", decrypted)
